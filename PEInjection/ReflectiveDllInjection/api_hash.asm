public api_hash
public dll_hash

.code

dll_hash proc

	mov rsi, rcx
	xor rcx, rcx
	xor rdx, rdx
	xor rax, rax

hash_calc:
	xor dl, dl
	mov dl, byte ptr [rsi + rcx]
	add ecx, 2
	ror eax, 0Dh
	add eax, edx
	mov dx, word ptr [rsi + rcx]
	cmp dx, 0
	jnz hash_calc

	ret

dll_hash endp

api_hash proc

	; rcx => loop
	; rsi => str
	; rax => hash_val
	; rbx => idx

	mov rsi, rcx
	xor rcx, rcx
	xor rdx, rdx
	xor rax, rax

hash_calc:
	xor dl, dl
	mov dl, byte ptr [rsi + rcx]
	inc rcx
	ror eax, 0Dh
	add eax, edx
	mov dl, byte ptr [rsi + rcx]
	cmp dl, 0
	jnz hash_calc
	ret

api_hash endp

end