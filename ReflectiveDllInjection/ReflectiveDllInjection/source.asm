public get_dll_buffer
public get_next_ldr
public get_dll_base
public get_ldr
public api_hashing
public dll_hashing

.code

api_hashing proc

	mov rsi, rcx
	xor rax, rax
	xor rbx, rbx
	xor rcx, rcx

hash_loop:
	xor rdx, rdx
	mov dl, byte ptr [rsi + rcx]
	inc rcx
	ror eax, 0Dh
	add eax, edx
	mov dl, byte ptr[rsi + rcx]
	cmp dl, 0
	jnz hash_loop
	ret

api_hashing endp

dll_hashing proc

	mov rsi, rcx
	xor rax, rax
	xor rbx, rbx
	xor rcx, rcx

hash_loop:
	xor rdx, rdx
	mov dl, byte ptr [rsi + rcx]
	add rcx, 2
	ror eax, 0Dh
	add eax, edx
	mov dx, word ptr[rsi + rcx]
	cmp dx, 0
	jnz hash_loop
	ret

dll_hashing endp

get_ldr proc
	mov rax, gs:[60h] ; _PEB
	mov rax, [rax + 18h]; _PEB_LDR_DATA
	mov rax, [rax + 10h]; _LDR_DATA_TABLE_ENTRY
	ret
get_ldr endp

get_dll_base proc
	mov rax, [rcx + 30h]
	ret
get_dll_base endp

get_next_ldr proc
	mov rax, [rcx]
	ret
get_next_ldr endp

get_dll_buffer proc
	mov rax, [rcx + 60h]
	ret
get_dll_buffer endp

end